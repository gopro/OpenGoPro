Presets
=======

The camera organizes modes of operation into :ref:`Presets <proto-wsdk_preset>` which consist of a camera mode and some corresponding settings.

The set of available *Presets* is dependent on the camera's current state such as the currently active settings. Therefore,
it is possible that the camera can be in a state where certain *Presets* can not currently be set. Special attention
should be paid to the following settings since these have a drastic effect on the set of currently available *Presets*:

- :operation:ref:`Control Mode <Setting 175>`

Recommended Usage
-----------------

The set of available Presets / Preset Groups can be found using :operation:ref:`Get Available Presets`. Depending on the
camera, this may be returned as a flat list or further separated into *Preset Groups*. It is possible for the groupings
to vary per camera. Also, none of the following *Preset* attributes are consistent across cameras:

- :ref:`Preset ID <proto-wsdk_preset>`
- :ref:`Preset Title ID<proto-wsdk_enumpresettitle>`
- :ref:`Preset Icon ID<proto-wsdk_enumpreseticon>`

The recommended procedure to query and set *Presets* is:

1. :operation:ref:`Get Available Presets` to retrieve a hierarchy of *Preset Groups*
2. Flatten all the *Preset Groups* into a flat list of *Presets*
3. Identify the desired *Preset* by its :ref:`Preset Title ID<proto-wsdk_enumpresettitle>`
4. Use the :ref:`Preset ID <proto-wsdk_preset>` from step 3 to load the Preset with :operation:ref:`Load Preset`

Preset Modified Status
----------------------

:operation:ref:`Status 98` returns the camera's Preset Modified Status value.

The value of this status is set to zero when the client sends a Get Preset Status message to the camera.

The value of this status is set to a non-zero value when:

- Preset settings submenu is exited in the camera UI (whether any settings were changed or not)
- A new preset is created
- A preset is deleted
- Preset ordering is changed within a preset group
- A preset is reset to factory defaults


Operations
----------

.. operation:protobuf:: Create Custom Preset
    :operation-id: GPCAMERA_CREATE_PRESET_V2

    .. operation:protobuf-message:: request
        :feature-id: 0xF1
        :action-id: 0x76
        :uuid: Command
        :message: WSDK_RequestCreateCustomPreset

    .. operation:protobuf-message:: response
        :feature-id: 0xF1
        :action-id: 0xF6
        :uuid: Command Response
        :message: WSDK_ResponseCreateCustomPreset

.. operation:protobuf:: Get Available Presets
    :operation-id: OGP_PRESETS_GET
    :external:

    .. operation:protobuf-message:: request
        :feature-id: 0xF5
        :action-id: 0x72
        :uuid: Query
        :message: WSDK_RequestGetPresetStatus

    .. operation:protobuf-message:: response
        :feature-id: 0xF5
        :action-id: 0xF2
        :uuid: Query Response
        :message: WSDK_NotifyPresetStatus

    .. operation:protobuf-message:: notification
        :feature-id: 0xF5
        :action-id: 0xF3
        :uuid: Query Response
        :message: WSDK_NotifyPresetStatus

.. operation:tlv-command:: Load Preset
   :operation-id: GPCAMERA_SET_PRESET
   :external:
   :id: 0x40

   Load preset by ID.

   A preset can only be loaded if it is currently available where available preset IDs can be
   found from :operation:ref:`Get Available Presets`

   .. operation:tlv-message:: Request
      :uuid: Command
      :params:
            - preset (uint32): preset ID
   .. operation:tlv-message:: Response
      :uuid: Command Response


.. operation:tlv-command:: Load Preset Group
   :operation-id: OGP_PRESET_SET_GROUP
   :external:
   :id: 0x3E

   The available group ID values can be found in :ref:`proto-wsdk_enumpresetgroup`

   .. operation:tlv-message:: Request
      :uuid: Command
      :params:
            - preset (uint32): preset group ID
   .. operation:tlv-message:: Response
      :uuid: Command Response

.. operation:protobuf:: Set Preset Visibility
   :operation-id: GPCAMERA_SET_PRESET_VISIBILITY
   :external:

    .. operation:protobuf-message:: request
        :feature-id: 0xF1
        :action-id: 0x63
        :uuid: Command
        :message: WSDK_RequestPresetSetVisibility

    .. operation:protobuf-message:: response
        :feature-id: 0xF1
        :action-id: 0xE3
        :uuid: Command Response
        :message: ResponseGeneric

.. operation:protobuf:: Update Custom Preset
   :operation-id: GPCAMERA_CUSTOM_PRESET_UPDATE
   :external:

    .. operation:protobuf-message:: request
        :feature-id: 0xF1
        :action-id: 0x64
        :uuid: Command
        :message: WSDK_RequestCustomPresetUpdate

    .. operation:protobuf-message:: response
        :feature-id: 0xF1
        :action-id: 0xE4
        :uuid: Command Response
        :message: ResponseGeneric
