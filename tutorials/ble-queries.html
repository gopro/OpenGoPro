<!DOCTYPE html>
<!--
  Minimal Mistakes Jekyll Theme 4.26.2 by Michael Rose
  Copyright 2013-2024 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
--><html lang="en-US" class="no-js">
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Tutorial 4: BLE TLV Queries -</title>
<meta name="description" content="This document will provide a walk-through tutorial to use the Open GoPro Interface to query the camera’s setting and status information via BLE.">


  <meta name="author" content="GoPro">
  
  <meta property="article:author" content="GoPro">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="">
<meta property="og:title" content="Tutorial 4: BLE TLV Queries">
<meta property="og:url" content="https://gopro.github.io/OpenGoPro/tutorials/ble-queries">


  <meta property="og:description" content="This document will provide a walk-through tutorial to use the Open GoPro Interface to query the camera’s setting and status information via BLE.">







  <meta property="article:published_time" content="2025-06-20T14:55:48-07:00">






<link rel="canonical" href="https://gopro.github.io/OpenGoPro/tutorials/ble-queries">












<!-- end _includes/seo.html -->


<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script type="text/javascript">
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
  
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/OpenGoPro/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css"></noscript>


  
    <script src="/OpenGoPro/assets/js/tabs.js"></script>
  
    <script src="/OpenGoPro/assets/js/quiz.js"></script>
  
    <script src="/OpenGoPro/assets/js/accordion.js"></script>
  


    <script src="https://cdn.jsdelivr.net/npm/anchor-js/anchor.min.js"></script>
<script>
    // Add anchors on DOMContentLoaded
    document.addEventListener('DOMContentLoaded', function (event) {
        var manualAnchors = new AnchorJS();
        manualAnchors.options = {
            titleText: 'Permalink',
            placement: 'left'
        };
        manualAnchors.add('.anchored');
    });
</script>
<link rel="apple-touch-icon" sizes="180x180" href="/OpenGoPro/assets/images/logos/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/OpenGoPro/assets/images/logos/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/OpenGoPro/assets/images/logos/favicon-16x16.png">
<link rel="manifest" href="/OpenGoPro/assets/images/logos/site.webmanifest">
<link rel="mask-icon" href="/OpenGoPro/assets/images/logos/safari-pinned-tab.svg" color="#5bbad5">
<link rel="shortcut icon" href="/OpenGoPro/assets/images/logos/favicon.ico">
<meta name="msapplication-TileColor" content="#2d89ef">
<meta name="msapplication-config" content="/assets/images/logos/browserconfig.xml">
<meta name="theme-color" content="#ffffff">

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/OpenGoPro/">
          
          
        </a>
        <ul class="visible-links">
<li class="masthead__menu-item">
              <a href="/OpenGoPro/">Home</a>
            </li>
<li class="masthead__menu-item">
              <a href="/OpenGoPro/ble/">BLE Spec</a>
            </li>
<li class="masthead__menu-item">
              <a href="/OpenGoPro/http">HTTP Spec</a>
            </li>
<li class="masthead__menu-item">
              <a href="/OpenGoPro/tutorials">Tutorials</a>
            </li>
<li class="masthead__menu-item">
              <a href="https://github.com/gopro/OpenGoPro/tree/main/demos">Demos</a>
            </li>
<li class="masthead__menu-item">
              <a href="/OpenGoPro/faq">FAQ</a>
            </li>
</ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <i class="fas fa-search"></i>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      




  
    



<nav class="breadcrumbs">
  <ol itemscope itemtype="https://schema.org/BreadcrumbList">
    
    
    
      
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="/OpenGoPro/" itemprop="item"><span itemprop="name">Home</span></a>

          <meta itemprop="position" content="1">
        </li>
        <span class="sep">/</span>
      
      
        
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="/OpenGoPro/tutorials" itemprop="item"><span itemprop="name">Tutorials</span></a>
          <meta itemprop="position" content="2">
        </li>
        <span class="sep">/</span>
      
    
      
      
        <li class="current">Tutorial 4: BLE TLV Queries</li>
      
    
  </ol>
</nav>

  


<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person" class="h-card">

  
    <div class="author__avatar">
      <a href="https://gopro.github.io/OpenGoPro/">
        <img src="/OpenGoPro/assets/images/logos/logo_square.png" alt="GoPro" itemprop="image" class="u-photo">
      </a>
    </div>
  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="https://gopro.github.io/OpenGoPro/" itemprop="url">GoPro</a>
    </h3>
    
      <div class="author__bio p-note" itemprop="description">
        <p>Be a <strong>hero</strong>.</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name" class="p-locality">US</span>
        </li>
      

      
        
          
            <li><a href="https://www.gopro.com" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fas fa-fw fa-link" aria-hidden="true"></i><span class="label">Website</span></a></li>
          
        
          
            <li><a href="https://twitter.com/GoPro" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
          
        
          
            <li><a href="https://www.facebook.com/gopro/" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-facebook-square" aria-hidden="true"></i><span class="label">Facebook</span></a></li>
          
        
          
            <li><a href="https://github.com/gopro" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
            <li><a href="https://www.instagram.com/gopro/" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i><span class="label">Instagram</span></a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
    
      
      
      
      
    
    
      <nav class="nav__list">
  
  <input id="ac-toc" name="accordion-toc" type="checkbox">
  <label for="ac-toc">Toggle menu</label>
  <ul class="nav__items">
    
      
      
        <li>
          
            <a href="/OpenGoPro/tutorials/connect-ble"><span class="nav__sub-title">1: Connect BLE</span></a>
          

          
        </li>
      
        <li>
          
            <a href="/OpenGoPro/tutorials/send-ble-commands"><span class="nav__sub-title">2: Send BLE Commands</span></a>
          

          
        </li>
      
        <li>
          
            <a href="/OpenGoPro/tutorials/parse-ble-responses"><span class="nav__sub-title">3: Parse BLE TLV Responses</span></a>
          

          
        </li>
      
        <li>
          
            <a href="/OpenGoPro/tutorials/ble-queries"><span class="nav__sub-title">4: BLE Queries</span></a>
          

          
        </li>
      
        <li>
          
            <a href="/OpenGoPro/tutorials/ble-protobuf"><span class="nav__sub-title">5: BLE Protobuf</span></a>
          

          
        </li>
      
        <li>
          
            <a href="/OpenGoPro/tutorials/connect-wifi"><span class="nav__sub-title">6: Connect WiFi</span></a>
          

          
        </li>
      
        <li>
          
            <a href="/OpenGoPro/tutorials/send-wifi-commands"><span class="nav__sub-title">7: Send WiFi Commands</span></a>
          

          
        </li>
      
        <li>
          
            <a href="/OpenGoPro/tutorials/camera-media-list"><span class="nav__sub-title">8: Camera Media List</span></a>
          

          
        </li>
      
        <li>
          
            <a href="/OpenGoPro/tutorials/cohn"><span class="nav__sub-title">9: Camera on the Home Network</span></a>
          

          
        </li>
      
    
  </ul>
</nav>

    
  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Tutorial 4: BLE TLV Queries">
    <meta itemprop="description" content="This document will provide a walk-through tutorial to use the Open GoPro Interface to query the camera’s settingand status information via BLE.">
    <meta itemprop="datePublished" content="2025-06-20T14:55:48-07:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">
            <a href="https://gopro.github.io/OpenGoPro/tutorials/ble-queries" itemprop="url">Tutorial 4: BLE TLV Queries
</a>
          </h1>
          

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          15 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              <header><h4 class="nav__title">
<i class="fas fa-file-alt"></i> On this page</h4></header>
              <ul class="toc__menu">
<li><a href="#requirements">Requirements</a></li>
<li><a href="#just-show-me-the-demos">Just Show me the Demo(s)!!</a></li>
<li><a href="#setup">Setup</a></li>
<li><a href="#parsing-a-query-response">Parsing a Query Response</a></li>
<li>
<a href="#polling-query-information">Polling Query Information</a><ul>
<li><a href="#individual-query-poll">Individual Query Poll</a></li>
<li><a href="#multiple-simultaneous-query-polls">Multiple Simultaneous Query Polls</a></li>
<li><a href="#query-all">Query All</a></li>
</ul>
</li>
<li><a href="#registering-for-query-push-notifications">Registering for Query Push Notifications</a></li>
<li><a href="#troubleshooting">Troubleshooting</a></li>
<li><a href="#good-job">Good Job!</a></li>
</ul>
            </nav>
          </aside>
        
        <p>This document will provide a walk-through tutorial to use the Open GoPro Interface to query the camera’s setting
and status information via BLE.</p>

<p><a href="/OpenGoPro/ble/protocol/data_protocol.html#queries">Queries</a> in this sense are operations that are initiated by
writing to the Query <a href="/OpenGoPro/ble/protocol/ble_setup.html#ble-characteristics">UUID</a> and receiving responses
via the Query Response <a href="/OpenGoPro/ble/protocol/ble_setup.html#ble-characteristics">UUID</a>.</p>

<p>A list of queries can be found in the <a href="/OpenGoPro/ble/protocol/id_tables.html#query-ids">Query ID Table</a>.</p>

<p>It is important to distinguish between queries and
<a href="/OpenGoPro/tutorials/send-ble-commands">commands</a> because they each have different request
and response packet formats.</p>

<div class="callout note">
<i class="fa fa-clipboard fa-2x" style="color: #3498db; margin: 0.25em;"></i><span>This tutorial only considers sending these queries as one-off queries. That is, it does not consider state
management / synchronization when sending multiple queries. This will be discussed in a future lab.</span>
</div>

<h1 id="requirements">Requirements</h1>

<p>It is assumed that the hardware and software requirements from the
<a href="/OpenGoPro/tutorials/connect-ble">connecting BLE tutorial</a>
are present and configured correctly.</p>

<div class="callout tip">
<i class="fa fa-tools fa-2x" style="color: #ebc21c; margin: 0.25em;"></i><span>It is suggested that you have first completed the
<a href="/OpenGoPro/tutorials/connect-ble#requirements">connect</a>,
<a href="/OpenGoPro/tutorials/send-ble-commands">sending commands</a>, and
<a href="/OpenGoPro/tutorials/parse-ble-responses">parsing responses</a> tutorials before going
through this tutorial.</span>
</div>

<h1 id="just-show-me-the-demos">Just Show me the Demo(s)!!</h1>

<div>
    <ul class="tab tab-linked" data-tab="506d678e-b281-4cc2-bb5f-58a7dd541380">
        
            <li class="active">
                <a href="">python </a>
            </li>
        
            <li>
                <a href="">kotlin </a>
            </li>
        
        </ul>
        <ul class="tab-content" id="506d678e-b281-4cc2-bb5f-58a7dd541380">
        
            <li class="active tab-content-container">
<p>Each of the scripts for this tutorial can be found in the Tutorial 4
<a href="https://github.com/gopro/OpenGoPro/tree/main/demos/python/tutorial/tutorial_modules/tutorial_4_ble_queries/">directory</a>.</p>

<div class="callout warning">
<i class="fa fa-exclamation-triangle fa-2x" style="color: #df5142; margin: 0.25em;"></i><span>Python &gt;= 3.9 and &lt; 3.12 must be used as specified in the requirements</span>
</div>

<div class="accordion-container anchored">
    <button class="accordion">Individual Query Poll<i class="fa fa-chevron-down"></i></button>
    <div class="panel">
<p>You can test an individual query poll with your camera through BLE using the following script:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>python ble_query_poll_resolution_value.py
</code></pre></div></div>

<p>See the help for parameter definitions:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>python ble_query_poll_resolution_value.py <span class="nt">--help</span>
<span class="go">usage: ble_query_poll_resolution_value.py [-h] [-i IDENTIFIER]

Connect to a GoPro camera, get the current resolution, modify the resolution, and confirm the change was successful.

optional arguments:
  -h, --help            show this help message and exit
  -i IDENTIFIER, --identifier IDENTIFIER
                        Last 4 digits of GoPro serial number, which is the last 4 digits of the
                        default camera SSID. If not used, first discovered GoPro will be connected to
</span></code></pre></div></div>

</div>
</div>

<div class="accordion-container anchored">
    <button class="accordion">Multiple Simultaneous Query Polls<i class="fa fa-chevron-down"></i></button>
    <div class="panel">
<p>You can test querying multiple queries simultaneously with your camera through BLE using the following script:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>python ble_query_poll_multiple_setting_values.py
</code></pre></div></div>

<p>See the help for parameter definitions:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>python ble_query_poll_multiple_setting_values.py <span class="nt">--help</span>
<span class="go">usage: ble_query_poll_multiple_setting_values.py [-h] [-i IDENTIFIER]

Connect to a GoPro camera then get the current resolution, fps, and fov.

optional arguments:
  -h, --help            show this help message and exit
  -i IDENTIFIER, --identifier IDENTIFIER
                        Last 4 digits of GoPro serial number, which is the last 4 digits of the
                        default camera SSID. If not used, first discovered GoPro will be connected to
</span></code></pre></div></div>

</div>
</div>

<div class="accordion-container anchored">
    <button class="accordion">Registering for Query Push Notifications<i class="fa fa-chevron-down"></i></button>
    <div class="panel">
<p>You can test registering for querties and receiving push notifications with your camera through BLE using the following
script:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>python ble_query_register_resolution_value_updates.py
</code></pre></div></div>

<p>See the help for parameter definitions:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>python ble_query_register_resolution_value_updates.py <span class="nt">--help</span>
<span class="go">usage: ble_query_register_resolution_value_updates.py [-h] [-i IDENTIFIER]

Connect to a GoPro camera, register for updates to the resolution, receive the current resolution, modify the resolution,
and confirm receipt of the change notification.

optional arguments:
  -h, --help            show this help message and exit
  -i IDENTIFIER, --identifier IDENTIFIER
                        Last 4 digits of GoPro serial number, which is the last 4 digits of the
                        default camera SSID. If not used, first discovered GoPro will be connected to
</span></code></pre></div></div>

</div>
</div>

</li>
        
            <li class="tab-content-container">
<p>The Kotlin file for this tutorial can be found on
<a href="https://github.com/gopro/OpenGoPro/tree/main/demos/kotlin/tutorial/app/src/main/java/com/example/open_gopro_tutorial/tutorials/Tutorial4BleQueries.kt">Github</a>.</p>

<p>To perform the tutorial, run the Android Studio project, select “Tutorial 4” from the dropdown and click on “Perform.”
This requires that a GoPro is already connected via BLE, i.e. that Tutorial 1 was already run. You can
check the BLE status at the top of the app.</p>

<figure class="" style="
        display: block;
        text-align: center;
        margin: 10px auto;
    ">
    <img src="/OpenGoPro/assets/images/tutorials/kotlin/tutorial_4.png" alt="kotlin_tutorial_4" style="
            width: 40%;
            display: block;
            margin-left: auto;
            margin-right: auto;
        "><figcaption>
            Perform Tutorial 4

        </figcaption></figure>

<p>This will start the tutorial and log to the screen as it executes. When the tutorial is complete, click
“Exit Tutorial” to return to the Tutorial selection screen.</p>

</li>
        
    </ul>
</div>

<h1 id="setup">Setup</h1>

<p>We must first connect as was discussed in the
<a href="/OpenGoPro/tutorials/connect-ble">connecting BLE tutorial</a>.</p>

<div>
    <ul class="tab tab-linked" data-tab="da1eba7d-0b86-4ef9-a37d-001e2da76e09">
        
            <li class="active">
                <a href="">python </a>
            </li>
        
            <li>
                <a href="">kotlin </a>
            </li>
        
        </ul>
        <ul class="tab-content" id="da1eba7d-0b86-4ef9-a37d-001e2da76e09">
        
            <li class="active tab-content-container">
<p>We have slightly updated the notification handler from the previous tutorial to handle a <code class="language-plaintext highlighter-rouge">QueryResponse</code> instead of
a <code class="language-plaintext highlighter-rouge">TlvResponse</code> where <code class="language-plaintext highlighter-rouge">QueryResponse</code> is a subclass of <code class="language-plaintext highlighter-rouge">TlvResponse</code> that will be created in this tutorial.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">responses_by_uuid</span> <span class="o">=</span> <span class="n">GoProUuid</span><span class="p">.</span><span class="nf">dict_by_uuid</span><span class="p">(</span><span class="n">QueryResponse</span><span class="p">)</span>
<span class="n">received_responses</span><span class="p">:</span> <span class="n">asyncio</span><span class="p">.</span><span class="n">Queue</span><span class="p">[</span><span class="n">QueryResponse</span><span class="p">]</span> <span class="o">=</span> <span class="n">asyncio</span><span class="p">.</span><span class="nc">Queue</span><span class="p">()</span>

<span class="n">query_request_uuid</span> <span class="o">=</span> <span class="n">GoProUuid</span><span class="p">.</span><span class="n">QUERY_REQ_UUID</span>
<span class="n">query_response_uuid</span> <span class="o">=</span> <span class="n">GoProUuid</span><span class="p">.</span><span class="n">QUERY_RSP_UUID</span>
<span class="n">setting_request_uuid</span> <span class="o">=</span> <span class="n">GoProUuid</span><span class="p">.</span><span class="n">SETTINGS_REQ_UUID</span>
<span class="n">setting_response_uuid</span> <span class="o">=</span> <span class="n">GoProUuid</span><span class="p">.</span><span class="n">SETTINGS_RSP_UUID</span>

<span class="k">async</span> <span class="k">def</span> <span class="nf">notification_handler</span><span class="p">(</span><span class="n">characteristic</span><span class="p">:</span> <span class="n">BleakGATTCharacteristic</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytearray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
    <span class="n">uuid</span> <span class="o">=</span> <span class="nc">GoProUuid</span><span class="p">(</span><span class="n">client</span><span class="p">.</span><span class="n">services</span><span class="p">.</span><span class="n">characteristics</span><span class="p">[</span><span class="n">characteristic</span><span class="p">.</span><span class="n">handle</span><span class="p">].</span><span class="n">uuid</span><span class="p">)</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">responses_by_uuid</span><span class="p">[</span><span class="n">uuid</span><span class="p">]</span>
    <span class="n">response</span><span class="p">.</span><span class="nf">accumulate</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="c1"># Notify the writer if we have received the entire response
</span>    <span class="k">if</span> <span class="n">response</span><span class="p">.</span><span class="n">is_received</span><span class="p">:</span>
        <span class="c1"># If this is query response, it must contain a resolution value
</span>        <span class="k">if</span> <span class="n">uuid</span> <span class="ow">is</span> <span class="n">query_response_uuid</span><span class="p">:</span>
            <span class="n">logger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sh">"</span><span class="s">Received a Query response</span><span class="sh">"</span><span class="p">)</span>
            <span class="k">await</span> <span class="n">received_responses</span><span class="p">.</span><span class="nf">put</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
        <span class="c1"># If this is a setting response, it will just show the status
</span>        <span class="k">elif</span> <span class="n">uuid</span> <span class="ow">is</span> <span class="n">setting_response_uuid</span><span class="p">:</span>
            <span class="n">logger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sh">"</span><span class="s">Received Set Setting command response.</span><span class="sh">"</span><span class="p">)</span>
            <span class="k">await</span> <span class="n">received_responses</span><span class="p">.</span><span class="nf">put</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
        <span class="c1"># Anything else is unexpected. This shouldn't happen
</span>        <span class="k">else</span><span class="p">:</span>
            <span class="n">logger</span><span class="p">.</span><span class="nf">error</span><span class="p">(</span><span class="sh">"</span><span class="s">Unexpected response</span><span class="sh">"</span><span class="p">)</span>
        <span class="c1"># Reset per-uuid Response
</span>        <span class="n">responses_by_uuid</span><span class="p">[</span><span class="n">uuid</span><span class="p">]</span> <span class="o">=</span> <span class="nc">QueryResponse</span><span class="p">(</span><span class="n">uuid</span><span class="p">)</span>
</code></pre></div></div>

<div class="callout note">
<i class="fa fa-clipboard fa-2x" style="color: #3498db; margin: 0.25em;"></i><span>The code above is taken from <code class="language-plaintext highlighter-rouge">ble_query_poll_resolution_value.py</code></span>
</div>

</li>
        
            <li class="tab-content-container">
<p>We are defining a resolution enum that will be updated as we receive new resolutions:</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">private</span> <span class="k">enum</span> <span class="kd">class</span> <span class="nc">Resolution</span><span class="p">(</span><span class="kd">val</span> <span class="py">value</span><span class="p">:</span> <span class="nc">UByte</span><span class="p">)</span> <span class="p">{</span>
    <span class="nc">RES_4K</span><span class="p">(</span><span class="mi">1U</span><span class="p">),</span>
    <span class="nc">RES_2_7K</span><span class="p">(</span><span class="mi">4U</span><span class="p">),</span>
    <span class="nc">RES_2_7K_4_3</span><span class="p">(</span><span class="mi">6U</span><span class="p">),</span>
    <span class="nc">RES_1080</span><span class="p">(</span><span class="mi">9U</span><span class="p">),</span>
    <span class="nc">RES_4K_4_3</span><span class="p">(</span><span class="mi">18U</span><span class="p">),</span>
    <span class="nc">RES_5K</span><span class="p">(</span><span class="mi">24U</span><span class="p">);</span>

    <span class="k">companion</span> <span class="k">object</span> <span class="p">{</span>
        <span class="k">private</span> <span class="kd">val</span> <span class="py">valueMap</span><span class="p">:</span> <span class="nc">Map</span><span class="p">&lt;</span><span class="nc">UByte</span><span class="p">,</span> <span class="nc">Resolution</span><span class="p">&gt;</span> <span class="k">by</span> <span class="nf">lazy</span> <span class="p">{</span> <span class="nf">values</span><span class="p">().</span><span class="nf">associateBy</span> <span class="p">{</span> <span class="n">it</span><span class="p">.</span><span class="n">value</span> <span class="p">}</span> <span class="p">}</span>

        <span class="k">fun</span> <span class="nf">fromValue</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="nc">UByte</span><span class="p">)</span> <span class="p">=</span> <span class="n">valueMap</span><span class="p">.</span><span class="nf">getValue</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">private</span> <span class="k">lateinit</span> <span class="kd">var</span> <span class="py">resolution</span><span class="p">:</span> <span class="nc">Resolution</span>
</code></pre></div></div>

</li>
        
    </ul>
</div>

<p>There are two methods to query status / setting information, each of which will be described in a following
section:</p>

<ul>
  <li><a href="/OpenGoPro/tutorials/ble-queries#polling-query-information">Polling Query Information</a></li>
  <li><a href="/OpenGoPro/tutorials/ble-queries#registering-for-query-push-notifications">Registering for query push notifications</a></li>
</ul>

<h1 id="parsing-a-query-response">Parsing a Query Response</h1>

<p>Before sending queries, we must first describe how Query response parsing differs from the Command response parsing
that was introduced in the previous tutorial.</p>

<p>To recap, the generic response format for both Commands and Queries is:</p>

<table>
  <thead>
    <tr>
      <th>Header (length)</th>
      <th>Operation ID (Command / Query ID)</th>
      <th>Status</th>
      <th>Response</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1-2 bytes</td>
      <td>1 byte</td>
      <td>1 bytes</td>
      <td>Length - 2 bytes</td>
    </tr>
  </tbody>
</table>

<p>Query Responses contain an array of additional TLV groups in the <strong>Response</strong> field as such:</p>

<table>
  <thead>
    <tr>
      <th>ID1</th>
      <th>Length1</th>
      <th>Value1</th>
      <th>ID2</th>
      <th>Length2</th>
      <th>Value 2</th>
      <th>…</th>
      <th>IDN</th>
      <th>LengthN</th>
      <th>ValueN</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1 byte</td>
      <td>1 byte</td>
      <td>Length1 bytes</td>
      <td>1 byte</td>
      <td>1 byte</td>
      <td>Length2 bytes</td>
      <td>…</td>
      <td>1 byte</td>
      <td>1 byte</td>
      <td>LengthN bytes</td>
    </tr>
  </tbody>
</table>

<p>We will be extending the <code class="language-plaintext highlighter-rouge">TlvResponse</code> class that was defined in the
<a href="/OpenGoPro/tutorials/parse-ble-responses">parsing responses</a> tutorial to perform common
parsing shared among all queries into a <code class="language-plaintext highlighter-rouge">QueryResponse</code> class as seen below:</p>

<hr>

<div class="md_column">
<div>

    <p>We have already parsed the length, Operation ID, and status, and extracted the payload in the <code class="language-plaintext highlighter-rouge">TlvResponse</code> class.
The next step is to parse the payload.</p>

    <p>Therefore, we now continuously parse <strong>Type (ID) - Length - Value</strong> groups until we have consumed the response. We are
storing each value in a hash map indexed by ID for later access.</p>

    <div>
    <ul class="tab tab-linked" data-tab="9d1af2a1-ebd0-4b1c-9410-b68326ebd56c">
        
            <li class="active">
                <a href="">python </a>
            </li>
        
            <li>
                <a href="">kotlin </a>
            </li>
        
        </ul>
        <ul class="tab-content" id="9d1af2a1-ebd0-4b1c-9410-b68326ebd56c">
        
            <li class="active tab-content-container">
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">QueryResponse</span><span class="p">(</span><span class="n">TlvResponse</span><span class="p">):</span>
    <span class="bp">...</span>

    <span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="nf">super</span><span class="p">().</span><span class="nf">parse</span><span class="p">()</span>
        <span class="n">buf</span> <span class="o">=</span> <span class="nf">bytearray</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">payload</span><span class="p">)</span>
        <span class="k">while</span> <span class="nf">len</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># Get ID and Length of query parameter
</span>            <span class="n">param_id</span> <span class="o">=</span> <span class="n">buf</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">param_len</span> <span class="o">=</span> <span class="n">buf</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">buf</span> <span class="o">=</span> <span class="n">buf</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>
            <span class="c1"># Get the value
</span>            <span class="n">value</span> <span class="o">=</span> <span class="n">buf</span><span class="p">[:</span><span class="n">param_len</span><span class="p">]</span>
            <span class="c1"># Store in dict for later access
</span>            <span class="n">self</span><span class="p">.</span><span class="n">data</span><span class="p">[</span><span class="n">param_id</span><span class="p">]</span> <span class="o">=</span> <span class="nf">bytes</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

            <span class="c1"># Advance the buffer
</span>            <span class="n">buf</span> <span class="o">=</span> <span class="n">buf</span><span class="p">[</span><span class="n">param_len</span><span class="p">:]</span>
</code></pre></div></div>

</li>
        
            <li class="tab-content-container">
<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">while</span> <span class="p">(</span><span class="n">buf</span><span class="p">.</span><span class="nf">isNotEmpty</span><span class="p">())</span> <span class="p">{</span>
    <span class="c1">// Get each parameter's ID and length</span>
    <span class="kd">val</span> <span class="py">paramId</span> <span class="p">=</span> <span class="n">buf</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="kd">val</span> <span class="py">paramLen</span> <span class="p">=</span> <span class="n">buf</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nf">toInt</span><span class="p">()</span>
    <span class="n">buf</span> <span class="p">=</span> <span class="n">buf</span><span class="p">.</span><span class="nf">drop</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="c1">// Get the parameter's value</span>
    <span class="kd">val</span> <span class="py">paramVal</span> <span class="p">=</span> <span class="n">buf</span><span class="p">.</span><span class="nf">take</span><span class="p">(</span><span class="n">paramLen</span><span class="p">)</span>
    <span class="c1">// Store in data dict for access later</span>
    <span class="n">data</span><span class="p">[</span><span class="n">paramId</span><span class="p">]</span> <span class="p">=</span> <span class="n">paramVal</span><span class="p">.</span><span class="nf">toUByteArray</span><span class="p">()</span>
    <span class="c1">// Advance the buffer for continued parsing</span>
    <span class="n">buf</span> <span class="p">=</span> <span class="n">buf</span><span class="p">.</span><span class="nf">drop</span><span class="p">(</span><span class="n">paramLen</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>

</li>
        
    </ul>
</div>

  </div>
<div style="flex:80%">

    <p><br><br><br></p>

    <svg class="plantuml" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentstyletype="text/css" height="604.5px" preserveaspectratio="none" style="width:303px;height:604px;background:#FFFFFF;" version="1.1" viewbox="0 0 303 604" width="303px" zoomandpan="magnify"><defs></defs><g><rect fill="#F1F1F1" height="50.9531" rx="18.75" ry="18.75" style="stroke:#181818;stroke-width:0.75;" width="168" x="66" y="16.5"></rect><text fill="#000000" font-family="sans-serif" font-size="18" lengthadjust="spacing" textlength="138" x="81" y="48.208">Parse Query ID</text><rect fill="#F1F1F1" height="50.9531" rx="18.75" ry="18.75" style="stroke:#181818;stroke-width:0.75;" width="151.5" x="74.25" y="97.4531"></rect><text fill="#000000" font-family="sans-serif" font-size="18" lengthadjust="spacing" textlength="121.5" x="89.25" y="129.1611">Parse Status</text><rect fill="#F1F1F1" height="50.9531" rx="18.75" ry="18.75" style="stroke:#181818;stroke-width:0.75;" width="145.5" x="77.25" y="261.9719"></rect><text fill="#000000" font-family="sans-serif" font-size="18" lengthadjust="spacing" textlength="115.5" x="92.25" y="293.6799">Get Value ID</text><rect fill="#F1F1F1" height="50.9531" rx="18.75" ry="18.75" style="stroke:#181818;stroke-width:0.75;" width="192" x="54" y="342.925"></rect><text fill="#000000" font-family="sans-serif" font-size="18" lengthadjust="spacing" textlength="162" x="69" y="374.6331">Get Value Length</text><rect fill="#F1F1F1" height="50.9531" rx="18.75" ry="18.75" style="stroke:#181818;stroke-width:0.75;" width="121.5" x="89.25" y="423.8782"></rect><text fill="#000000" font-family="sans-serif" font-size="18" lengthadjust="spacing" textlength="91.5" x="104.25" y="455.5862">Get Value</text><polygon fill="#F1F1F1" points="102,178.4063,198,178.4063,216,196.4063,198,214.4063,102,214.4063,84,196.4063,102,178.4063" style="stroke:#181818;stroke-width:0.75;"></polygon><text fill="#000000" font-family="sans-serif" font-size="16.5" lengthadjust="spacing" textlength="30" x="156" y="229.7219">yes</text><text fill="#000000" font-family="sans-serif" font-size="16.5" lengthadjust="spacing" textlength="96" x="102" y="202.1184">More Data?</text><text fill="#000000" font-family="sans-serif" font-size="16.5" lengthadjust="spacing" textlength="21" x="63" y="192.5149">no</text><rect fill="#F1F1F1" height="50.9531" rx="18.75" ry="18.75" style="stroke:#181818;stroke-width:0.75;" width="79.5" x="110.25" y="537.8313"></rect><text fill="#000000" font-family="sans-serif" font-size="18" lengthadjust="spacing" textlength="49.5" x="125.25" y="569.5393">Done</text><line style="stroke:#181818;stroke-width:1.5;" x1="150" x2="150" y1="67.4531" y2="97.4531"></line><polygon fill="#181818" points="144,82.4531,150,97.4531,156,82.4531,150,88.4531" style="stroke:#181818;stroke-width:1.5;"></polygon><line style="stroke:#181818;stroke-width:1.5;" x1="150" x2="150" y1="312.925" y2="342.925"></line><polygon fill="#181818" points="144,327.925,150,342.925,156,327.925,150,333.925" style="stroke:#181818;stroke-width:1.5;"></polygon><line style="stroke:#181818;stroke-width:1.5;" x1="150" x2="150" y1="393.8782" y2="423.8782"></line><polygon fill="#181818" points="144,408.8782,150,423.8782,156,408.8782,150,414.8782" style="stroke:#181818;stroke-width:1.5;"></polygon><line style="stroke:#181818;stroke-width:1.5;" x1="150" x2="150" y1="214.4063" y2="261.9719"></line><polygon fill="#181818" points="144,246.9719,150,261.9719,156,246.9719,150,252.9719" style="stroke:#181818;stroke-width:1.5;"></polygon><line style="stroke:#181818;stroke-width:1.5;" x1="150" x2="150" y1="474.8313" y2="489.8313"></line><line style="stroke:#181818;stroke-width:1.5;" x1="150" x2="264" y1="489.8313" y2="489.8313"></line><polygon fill="#181818" points="258,355.7981,264,340.7981,270,355.7981,264,349.7981" style="stroke:#181818;stroke-width:1.5;"></polygon><line style="stroke:#181818;stroke-width:1.5;" x1="264" x2="264" y1="196.4063" y2="489.8313"></line><line style="stroke:#181818;stroke-width:1.5;" x1="264" x2="216" y1="196.4063" y2="196.4063"></line><polygon fill="#181818" points="231,190.4063,216,196.4063,231,202.4063,225,196.4063" style="stroke:#181818;stroke-width:1.5;"></polygon><line style="stroke:#181818;stroke-width:1.5;" x1="84" x2="36" y1="196.4063" y2="196.4063"></line><polygon fill="#181818" points="30,334.7981,36,349.7981,42,334.7981,36,340.7981" style="stroke:#181818;stroke-width:1.5;"></polygon><line style="stroke:#181818;stroke-width:1.5;" x1="36" x2="36" y1="196.4063" y2="507.8313"></line><line style="stroke:#181818;stroke-width:1.5;" x1="36" x2="150" y1="507.8313" y2="507.8313"></line><line style="stroke:#181818;stroke-width:1.5;" x1="150" x2="150" y1="507.8313" y2="537.8313"></line><polygon fill="#181818" points="144,522.8313,150,537.8313,156,522.8313,150,528.8313" style="stroke:#181818;stroke-width:1.5;"></polygon><line style="stroke:#181818;stroke-width:1.5;" x1="150" x2="150" y1="148.4063" y2="178.4063"></line><polygon fill="#181818" points="144,163.4063,150,178.4063,156,163.4063,150,169.4063" style="stroke:#181818;stroke-width:1.5;"></polygon></g></svg>

  </div>
</div>

<div id="quiz_07e40729-4f84-4ae0-97f2-4fb59490d706" class="quiz">
    <div>
        <div id="question_07e40729-4f84-4ae0-97f2-4fb59490d706" class="quiz__question">How many packets are query responses?</div>
        <div id="answers_07e40729-4f84-4ae0-97f2-4fb59490d706">
        
            <input type="radio" name="question" value="A"><label>A: Always 1 packet</label>
            <br>
        
            <input type="radio" name="question" value="B"><label>B: Always multiple packets</label>
            <br>
        
            <input type="radio" name="question" value="C"><label>C: Can be 1 or multiple packets</label>
            <br>
        
        </div>
    </div>
    <button onclick="showResults('07e40729-4f84-4ae0-97f2-4fb59490d706', 'C')">Submit Answer</button>
    <div id="results_07e40729-4f84-4ae0-97f2-4fb59490d706" style="display: none">
        <span id="correct_07e40729-4f84-4ae0-97f2-4fb59490d706" style="display: none">  Correct!! 😃</span>
        <span id="incorrect_07e40729-4f84-4ae0-97f2-4fb59490d706" style="display: none"> Incorrect!! 😭 The correct answer is C.</span>
        Query responses can be one packet (if for example querying a specific
setting) or multiple packets (when querying many or all settings as in the example here).
    </div>
</div>

<div id="quiz_3482d5cd-bc02-4a1d-8bb8-db2fc9a3528a" class="quiz">
    <div>
        <div id="question_3482d5cd-bc02-4a1d-8bb8-db2fc9a3528a" class="quiz__question">Which field is not common to all TLV responses?</div>
        <div id="answers_3482d5cd-bc02-4a1d-8bb8-db2fc9a3528a">
        
            <input type="radio" name="question" value="A"><label>A: length</label>
            <br>
        
            <input type="radio" name="question" value="B"><label>B: status</label>
            <br>
        
            <input type="radio" name="question" value="C"><label>C: ID</label>
            <br>
        
            <input type="radio" name="question" value="D"><label>D: None of the Above</label>
            <br>
        
        </div>
    </div>
    <button onclick="showResults('3482d5cd-bc02-4a1d-8bb8-db2fc9a3528a', 'D')">Submit Answer</button>
    <div id="results_3482d5cd-bc02-4a1d-8bb8-db2fc9a3528a" style="display: none">
        <span id="correct_3482d5cd-bc02-4a1d-8bb8-db2fc9a3528a" style="display: none">  Correct!! 😃</span>
        <span id="incorrect_3482d5cd-bc02-4a1d-8bb8-db2fc9a3528a" style="display: none"> Incorrect!! 😭 The correct answer is D.</span>
        All Commands and Query responses have a length, ID, and status.
    </div>
</div>

<h1 id="polling-query-information">Polling Query Information</h1>

<p>It is possible to poll one or more setting / status values using the following queries:</p>

<table>
  <thead>
    <tr>
      <th>Query ID</th>
      <th>Request</th>
      <th>Query</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0x12</td>
      <td><a href="/OpenGoPro/ble/features/query.html#get-setting-values">Get Setting value(s)</a></td>
      <td>len:12:xx:xx</td>
    </tr>
    <tr>
      <td>0x13</td>
      <td><a href="/OpenGoPro/ble/features/query.html#get-status-values">Get Status value(s)</a></td>
      <td>len:13:xx:xx</td>
    </tr>
  </tbody>
</table>

<p>where <strong>xx</strong> are setting / status ID(s) and <strong>len</strong> is the length of the rest of the query (the number of query bytes
plus one for the request ID byte). There will be specific examples below.</p>

<div class="callout note">
<i class="fa fa-clipboard fa-2x" style="color: #3498db; margin: 0.25em;"></i><span>Since they are two separate queries, combination of settings / statuses can not be polled simultaneously.</span>
</div>

<p>Here is a generic sequence diagram (the same is true for statuses):</p>

<svg class="plantuml" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentstyletype="text/css" height="272px" preserveaspectratio="none" style="width:544px;height:272px;background:#FFFFFF;" version="1.1" viewbox="0 0 544 272" width="544px" zoomandpan="magnify"><defs></defs><g><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="96" x2="96" y1="36.2969" y2="237.0938"></line><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="479" x2="479" y1="36.2969" y2="237.0938"></line><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="183" x="5" y="5"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="169" x="12" y="24.9951">Open GoPro user device</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="183" x="5" y="236.0938"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="169" x="12" y="256.0889">Open GoPro user device</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="57" x="451" y="5"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="43" x="458" y="24.9951">GoPro</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="57" x="451" y="236.0938"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="43" x="458" y="256.0889">GoPro</text><path d="M39,51.2969 L39,76.2969 L537,76.2969 L537,61.2969 L527,51.2969 L39,51.2969 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"></path><path d="M527,51.2969 L527,61.2969 L537,61.2969 L527,51.2969 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"></path><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="256" x="155.5" y="68.3638">Connected (steps from connect tutorial)</text><line style="stroke:#181818;stroke-width:1.0;" x1="477.5" x2="467.5" y1="102.5625" y2="98.5625"></line><line style="stroke:#181818;stroke-width:1.0;" x1="477.5" x2="467.5" y1="102.5625" y2="106.5625"></line><line style="stroke:#181818;stroke-width:1.0;" x1="96.5" x2="478.5" y1="102.5625" y2="102.5625"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="322" x="103.5" y="97.4966">Get Setting value(s) queries written to Query UUID</text><line style="stroke:#181818;stroke-width:1.0;" x1="97.5" x2="107.5" y1="131.6953" y2="127.6953"></line><line style="stroke:#181818;stroke-width:1.0;" x1="97.5" x2="107.5" y1="131.6953" y2="135.6953"></line><line style="stroke:#181818;stroke-width:1.0;" x1="96.5" x2="478.5" y1="131.6953" y2="131.6953"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="325" x="113.5" y="126.6294">Setting values responded to Query Response UUID</text><line style="stroke:#181818;stroke-width:1.0;" x1="97.5" x2="107.5" y1="160.8281" y2="156.8281"></line><line style="stroke:#181818;stroke-width:1.0;" x1="97.5" x2="107.5" y1="160.8281" y2="164.8281"></line><line style="stroke:#181818;stroke-width:1.0;" x1="96.5" x2="478.5" y1="160.8281" y2="160.8281"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="359" x="113.5" y="155.7622">More setting values responded to Query Response UUID</text><line style="stroke:#181818;stroke-width:1.0;" x1="97.5" x2="107.5" y1="189.9609" y2="185.9609"></line><line style="stroke:#181818;stroke-width:1.0;" x1="97.5" x2="107.5" y1="189.9609" y2="193.9609"></line><line style="stroke:#181818;stroke-width:1.0;" x1="96.5" x2="478.5" y1="189.9609" y2="189.9609"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="12" x="113.5" y="184.895">...</text><line style="stroke:#181818;stroke-width:1.0;" x1="97.5" x2="107.5" y1="219.0938" y2="215.0938"></line><line style="stroke:#181818;stroke-width:1.0;" x1="97.5" x2="107.5" y1="219.0938" y2="223.0938"></line><line style="stroke:#181818;stroke-width:1.0;" x1="96.5" x2="478.5" y1="219.0938" y2="219.0938"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="359" x="113.5" y="214.0278">More setting values responded to Query Response UUID</text></g></svg>

<p>The number of notification responses will vary depending on the amount of settings that have been queried.
Note that setting values will be combined into one notification until it reaches the maximum notification
size (20 bytes). At this point, a new response will be sent. Therefore, it is necessary to accumulate and then
parse these responses as was described in
<a href="/OpenGoPro/tutorials/parse-ble-responses#parsing-multiple-packet-tlv-responses">parsing query responses</a></p>

<h2 id="individual-query-poll">Individual Query Poll</h2>

<p>Here we will walk through an example of polling one setting (Resolution).</p>

<p>First we send the query:</p>

<div>
    <ul class="tab tab-linked" data-tab="938b9457-217f-4f46-ab57-6154b8b0f790">
        
            <li class="active">
                <a href="">python </a>
            </li>
        
            <li>
                <a href="">kotlin </a>
            </li>
        
        </ul>
        <ul class="tab-content" id="938b9457-217f-4f46-ab57-6154b8b0f790">
        
            <li class="active tab-content-container">
<div class="callout note">
<i class="fa fa-clipboard fa-2x" style="color: #3498db; margin: 0.25em;"></i><span>The sample code can be found in in <code class="language-plaintext highlighter-rouge">ble_query_poll_resolution_value.py</code>.</span>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">query_request_uuid</span> <span class="o">=</span> <span class="n">GoProUuid</span><span class="p">.</span><span class="n">QUERY_REQ_UUID</span>
<span class="n">request</span> <span class="o">=</span> <span class="nf">bytes</span><span class="p">([</span><span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x12</span><span class="p">,</span> <span class="n">RESOLUTION_ID</span><span class="p">])</span>
<span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">write_gatt_char</span><span class="p">(</span><span class="n">query_request_uuid</span><span class="p">.</span><span class="n">value</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

</li>
        
            <li class="tab-content-container">
<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">val</span> <span class="py">pollResolution</span> <span class="p">=</span> <span class="nf">ubyteArrayOf</span><span class="p">(</span><span class="mh">0x02U</span><span class="p">,</span> <span class="mh">0x12U</span><span class="p">,</span> <span class="nc">RESOLUTION_ID</span><span class="p">)</span>
<span class="n">ble</span><span class="p">.</span><span class="nf">writeCharacteristic</span><span class="p">(</span><span class="n">goproAddress</span><span class="p">,</span> <span class="nc">GoProUUID</span><span class="p">.</span><span class="nc">CQ_QUERY</span><span class="p">.</span><span class="n">uuid</span><span class="p">,</span> <span class="n">pollResolution</span><span class="p">)</span>
</code></pre></div></div>

</li>
        
    </ul>
</div>

<p>Then when the response is received from the notification handler we parse it into individual query elements in the
<code class="language-plaintext highlighter-rouge">QueryResponse</code> class and extract the new resolution value.</p>

<div>
    <ul class="tab tab-linked" data-tab="4c486d1c-c211-4efa-b83c-d947e6788141">
        
            <li class="active">
                <a href="">python </a>
            </li>
        
            <li>
                <a href="">kotlin </a>
            </li>
        
        </ul>
        <ul class="tab-content" id="4c486d1c-c211-4efa-b83c-d947e6788141">
        
            <li class="active tab-content-container">
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Wait to receive the notification response
</span><span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">received_responses</span><span class="p">.</span><span class="nf">get</span><span class="p">()</span>
<span class="n">response</span><span class="p">.</span><span class="nf">parse</span><span class="p">()</span>
<span class="n">resolution</span> <span class="o">=</span> <span class="nc">Resolution</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">data</span><span class="p">[</span><span class="n">RESOLUTION_ID</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</code></pre></div></div>

<p>which logs as such:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="go">Getting the current resolution
 Writing to GoProUuid.QUERY_REQ_UUID: 02:12:02
Received response at handle=62: b'05:12:00:02:01:09'
eceived the Resolution Query response
Resolution is currently Resolution.RES_1080
</span></code></pre></div></div>

</li>
        
            <li class="tab-content-container">
<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Wait to receive the response and then convert it to resolution</span>
<span class="kd">val</span> <span class="py">queryResponse</span> <span class="p">=</span> <span class="p">(</span><span class="n">receivedResponses</span><span class="p">.</span><span class="nf">receive</span><span class="p">()</span> <span class="k">as</span> <span class="nc">Response</span><span class="p">.</span><span class="nc">Query</span><span class="p">).</span><span class="nf">apply</span> <span class="p">{</span> <span class="nf">parse</span><span class="p">()</span> <span class="p">}</span>
<span class="n">resolution</span> <span class="p">=</span> <span class="nc">Resolution</span><span class="p">.</span><span class="nf">fromValue</span><span class="p">(</span><span class="n">queryResponse</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="nf">getValue</span><span class="p">(</span><span class="nc">RESOLUTION_ID</span><span class="p">).</span><span class="nf">first</span><span class="p">())</span>
</code></pre></div></div>

<p>which logs as such:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="go">Polling the current resolution
</span><span class="gp">Writing characteristic b5f90076-aa8d-11e3-9046-0002a5d5c51b ==&gt;</span><span class="w"> </span>02:12:02
<span class="go">Wrote characteristic b5f90076-aa8d-11e3-9046-0002a5d5c51b
Characteristic b5f90077-aa8d-11e3-9046-0002a5d5c51b changed | value: 05:12:00:02:01:09
Received response on CQ_QUERY_RSP
Received packet of length 5. 0 bytes remaining
Received Query Response
Camera resolution is RES_1080
</span></code></pre></div></div>

</li>
        
    </ul>
</div>

<p>For verification purposes, we are then changing the resolution and polling again to verify that the setting
has changed:</p>

<div>
    <ul class="tab tab-linked" data-tab="5aebe2bc-1871-4f56-acae-a5bc87a230e7">
        
            <li class="active">
                <a href="">python </a>
            </li>
        
            <li>
                <a href="">kotlin </a>
            </li>
        
        </ul>
        <ul class="tab-content" id="5aebe2bc-1871-4f56-acae-a5bc87a230e7">
        
            <li class="active tab-content-container">
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">while</span> <span class="n">resolution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">target_resolution</span><span class="p">:</span>
    <span class="n">request</span> <span class="o">=</span> <span class="nf">bytes</span><span class="p">([</span><span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x12</span><span class="p">,</span> <span class="n">RESOLUTION_ID</span><span class="p">])</span>
    <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">write_gatt_char</span><span class="p">(</span><span class="n">query_request_uuid</span><span class="p">.</span><span class="n">value</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">received_responses</span><span class="p">.</span><span class="nf">get</span><span class="p">()</span>  <span class="c1"># Wait to receive the notification response
</span>    <span class="n">response</span><span class="p">.</span><span class="nf">parse</span><span class="p">()</span>
    <span class="n">resolution</span> <span class="o">=</span> <span class="nc">Resolution</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">data</span><span class="p">[</span><span class="n">RESOLUTION_ID</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</code></pre></div></div>

<p>which logs as such:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="go">Changing the resolution to Resolution.RES_2_7K...
Writing to GoProUuid.SETTINGS_REQ_UUID: 03:02:01:04
Writing to GoProUuid.SETTINGS_REQ_UUID: 03:02:01:04
Received response at GoProUuid.SETTINGS_RSP_UUID: 02:02:00
Received Set Setting command response.
Polling the resolution to see if it has changed...
Writing to GoProUuid.QUERY_REQ_UUID: 02:12:02
Received response at GoProUuid.QUERY_RSP_UUID: 05:12:00:02:01:04
Received the Resolution Query response
Resolution is currently Resolution.RES_2_7K
Resolution has changed as expected. Exiting...
</span></code></pre></div></div>

</li>
        
            <li class="tab-content-container">
<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">while</span> <span class="p">(</span><span class="n">resolution</span> <span class="p">!=</span> <span class="n">newResolution</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">ble</span><span class="p">.</span><span class="nf">writeCharacteristic</span><span class="p">(</span><span class="n">goproAddress</span><span class="p">,</span> <span class="nc">GoProUUID</span><span class="p">.</span><span class="nc">CQ_QUERY</span><span class="p">.</span><span class="n">uuid</span><span class="p">,</span> <span class="n">pollResolution</span><span class="p">)</span>
    <span class="kd">val</span> <span class="py">queryNotification</span> <span class="p">=</span> <span class="p">(</span><span class="n">receivedResponses</span><span class="p">.</span><span class="nf">receive</span><span class="p">()</span> <span class="k">as</span> <span class="nc">Response</span><span class="p">.</span><span class="nc">Query</span><span class="p">).</span><span class="nf">apply</span> <span class="p">{</span> <span class="nf">parse</span><span class="p">()</span> <span class="p">}</span>
    <span class="n">resolution</span> <span class="p">=</span> <span class="nc">Resolution</span><span class="p">.</span><span class="nf">fromValue</span><span class="p">(</span><span class="n">queryNotification</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="nf">getValue</span><span class="p">(</span><span class="nc">RESOLUTION_ID</span><span class="p">).</span><span class="nf">first</span><span class="p">())</span>
<span class="p">}</span>
</code></pre></div></div>

<p>which logs as such:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="go">Changing the resolution to RES_2_7K
</span><span class="gp">Writing characteristic b5f90074-aa8d-11e3-9046-0002a5d5c51b ==&gt;</span><span class="w"> </span>03:02:01:04
<span class="go">Wrote characteristic b5f90074-aa8d-11e3-9046-0002a5d5c51b
Characteristic b5f90075-aa8d-11e3-9046-0002a5d5c51b changed | value: 02:02:00
Received response on CQ_SETTING_RSP
Received packet of length 2. 0 bytes remaining
Received set setting response.
Resolution successfully changed
Polling the resolution until it changes
</span><span class="gp">Writing characteristic b5f90076-aa8d-11e3-9046-0002a5d5c51b ==&gt;</span><span class="w"> </span>02:12:02
<span class="go">Characteristic b5f90077-aa8d-11e3-9046-0002a5d5c51b changed | value: 05:12:00:02:01:04
Received response on CQ_QUERY_RSP
Received packet of length 5. 0 bytes remaining
Received Query Response
Wrote characteristic b5f90076-aa8d-11e3-9046-0002a5d5c51b
Camera resolution is currently RES_2_7K
</span></code></pre></div></div>

</li>
        
    </ul>
</div>

<h2 id="multiple-simultaneous-query-polls">Multiple Simultaneous Query Polls</h2>

<p>Rather than just polling one setting, it is also possible to poll multiple settings. An example of this is shown
below. It is very similar to the previous example except that the query now includes 3 settings:
<a href="/OpenGoPro/ble/features/settings.html#setting-2">Resolution</a>,
<a href="/OpenGoPro/ble/features/settings.html#setting-3">FPS</a>,
and <a href="/OpenGoPro/ble/features/settings.html#setting-121">FOV</a>.</p>

<div>
    <ul class="tab tab-linked" data-tab="504631d9-304a-471c-9360-3f1d7e7bb1f3">
        
            <li class="active">
                <a href="">python </a>
            </li>
        
            <li>
                <a href="">kotlin </a>
            </li>
        
        </ul>
        <ul class="tab-content" id="504631d9-304a-471c-9360-3f1d7e7bb1f3">
        
            <li class="active tab-content-container">
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">RESOLUTION_ID</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">FPS_ID</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">FOV_ID</span> <span class="o">=</span> <span class="mi">121</span>

<span class="n">request</span> <span class="o">=</span> <span class="nf">bytes</span><span class="p">([</span><span class="mh">0x04</span><span class="p">,</span> <span class="mh">0x12</span><span class="p">,</span> <span class="n">RESOLUTION_ID</span><span class="p">,</span> <span class="n">FPS_ID</span><span class="p">,</span> <span class="n">FOV_ID</span><span class="p">])</span>
<span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">write_gatt_char</span><span class="p">(</span><span class="n">query_request_uuid</span><span class="p">.</span><span class="n">value</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">received_responses</span><span class="p">.</span><span class="nf">get</span><span class="p">()</span>  <span class="c1"># Wait to receive the notification response
</span></code></pre></div></div>

</li>
        
            <li class="tab-content-container">
<p>TODO</p>
</li>
        
    </ul>
</div>

<div class="callout note">
<i class="fa fa-clipboard fa-2x" style="color: #3498db; margin: 0.25em;"></i><span>The length (first byte of the query) has been increased to 4 to accommodate the extra settings</span>
</div>

<p>We are also parsing the response to get all 3 values:</p>

<div>
    <ul class="tab tab-linked" data-tab="809f44eb-3a87-46fa-92d9-ba342922978e">
        
            <li class="active">
                <a href="">python </a>
            </li>
        
            <li>
                <a href="">kotlin </a>
            </li>
        
        </ul>
        <ul class="tab-content" id="809f44eb-3a87-46fa-92d9-ba342922978e">
        
            <li class="active tab-content-container">
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">response</span><span class="p">.</span><span class="nf">parse</span><span class="p">()</span>
<span class="n">logger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Resolution is currently </span><span class="si">{</span><span class="nc">Resolution</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">data</span><span class="p">[</span><span class="n">RESOLUTION_ID</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="n">logger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Video FOV is currently </span><span class="si">{</span><span class="nc">VideoFOV</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">data</span><span class="p">[</span><span class="n">FOV_ID</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="n">logger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">FPS is currently </span><span class="si">{</span><span class="nc">FPS</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">data</span><span class="p">[</span><span class="n">FPS_ID</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div>

</li>
        
            <li class="tab-content-container">
<p>TODO</p>
</li>
        
    </ul>
</div>

<div class="callout tip">
<i class="fa fa-tools fa-2x" style="color: #ebc21c; margin: 0.25em;"></i><span>When we are storing the updated setting, we are just taking the first byte (i..e index 0). A real-world
implementation would need to know the length (and type) of the setting / status response by the ID. For example,
sometimes settings / statuses are bytes, words, strings, etc.</span>
</div>

<p>They are then printed to the log which will look like the following:</p>

<div>
    <ul class="tab tab-linked" data-tab="18347e31-23b8-422c-9254-d928ed6b749e">
        
            <li class="active">
                <a href="">python </a>
            </li>
        
            <li>
                <a href="">kotlin </a>
            </li>
        
        </ul>
        <ul class="tab-content" id="18347e31-23b8-422c-9254-d928ed6b749e">
        
            <li class="active tab-content-container">
<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="go">Getting the current resolution, fps, and fov.
Writing to GoProUuid.QUERY_REQ_UUID: 04:12:02:03:79
Received response at GoProUuid.QUERY_RSP_UUID: 0b:12:00:02:01:09:03:01:00:79:01:00
Received the Query Response
Resolution is currently Resolution.RES_1080
Video FOV is currently VideoFOV.FOV_WIDE
FPS is currently FPS.FPS_240
</span></code></pre></div></div>

</li>
        
            <li class="tab-content-container">
<p>TODO</p>
</li>
        
    </ul>
</div>

<p>In general, we can parse query values by looking at relevant documentation linked from the
<a href="/OpenGoPro/ble/protocol/id_tables.html#setting-ids">Setting</a> or
<a href="/OpenGoPro/ble/protocol/id_tables.html#status-ids">Status</a> ID tables.</p>

<p>For example (for settings):</p>

<ul>
  <li>ID 2 == 9 equates to <a href="/OpenGoPro/ble/features/settings.html#setting-2">Resolution</a> == 1080</li>
  <li>ID 3 == 1 equates to <a href="/OpenGoPro/ble/features/settings.html#setting-3">FPS</a> == 120</li>
</ul>

<h2 id="query-all">Query All</h2>

<p>It is also possible to query all settings / statuses by not passing any ID’s into the the query, i.e.:</p>

<table>
  <thead>
    <tr>
      <th>Query ID</th>
      <th>Request</th>
      <th>Query</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0x12</td>
      <td>Get All Settings</td>
      <td>01:12</td>
    </tr>
    <tr>
      <td>0x13</td>
      <td>Get All Statuses</td>
      <td>01:13</td>
    </tr>
  </tbody>
</table>

<p><strong>Quiz time! 📚 ✏️</strong></p>

<div id="quiz_e7655436-8acc-4cd3-831a-6bbd2cdf3724" class="quiz">
    <div>
        <div id="question_e7655436-8acc-4cd3-831a-6bbd2cdf3724" class="quiz__question">How can we poll the encoding status and the resolution setting using one query?</div>
        <div id="answers_e7655436-8acc-4cd3-831a-6bbd2cdf3724">
        
            <input type="radio" name="question" value="A"><label>A: Concatenate a ‘Get Setting Value’ query and a ‘Get Status’ query with the relevant ID’s</label>
            <br>
        
            <input type="radio" name="question" value="B"><label>B: Concatenate the ‘Get All Setting’ and ‘Get All Status’ queries.</label>
            <br>
        
            <input type="radio" name="question" value="C"><label>C: It is not possible</label>
            <br>
        
        </div>
    </div>
    <button onclick="showResults('e7655436-8acc-4cd3-831a-6bbd2cdf3724', 'C')">Submit Answer</button>
    <div id="results_e7655436-8acc-4cd3-831a-6bbd2cdf3724" style="display: none">
        <span id="correct_e7655436-8acc-4cd3-831a-6bbd2cdf3724" style="display: none">  Correct!! 😃</span>
        <span id="incorrect_e7655436-8acc-4cd3-831a-6bbd2cdf3724" style="display: none"> Incorrect!! 😭 The correct answer is C.</span>
        It is not possible to concatenate queries. This would result in an unknown sequence of bytes
        from the camera’s perspective. So it is not possible to get a setting value and a status value in one
        query. The Get Setting Query (with resolution ID) and Get Status Query (with encoding ID) must be
        sent sequentially in order to get this information.
    </div>
</div>

<h1 id="registering-for-query-push-notifications">Registering for Query Push Notifications</h1>

<p>Rather than polling the query information, it is also possible to use an interrupt scheme to register for
push notifications when the relevant query information changes.</p>

<p>The relevant queries are:</p>

<table>
  <thead>
    <tr>
      <th>Query ID</th>
      <th>Request</th>
      <th>Query</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0x52</td>
      <td><a href="/OpenGoPro/ble/features/query.html#register-for-setting-value-updates">Register updates for setting(s)</a></td>
      <td>len:52:xx:xx</td>
    </tr>
    <tr>
      <td>0x53</td>
      <td><a href="/OpenGoPro/ble/features/query.html#register-for-status-value-updates">Register updates for status(es)</a></td>
      <td>len:53:xx:xx</td>
    </tr>
    <tr>
      <td>0x72</td>
      <td><a href="/OpenGoPro/ble/features/query.html#unregister-for-setting-value-updates">Unregister updates for setting(s)</a></td>
      <td>len:72:xx:xx</td>
    </tr>
    <tr>
      <td>0x73</td>
      <td><a href="/OpenGoPro/ble/features/query.html#unregister-for-status-value-updates">Unregister updates for status(es)</a></td>
      <td>len:73:xx:xx</td>
    </tr>
  </tbody>
</table>

<p>where <strong>xx</strong> are setting / status ID(s) and <strong>len</strong> is the length of the rest of the query (the number of query bytes plus one for the request ID byte).</p>

<p>The <a href="/OpenGoPro/ble/protocol/id_tables.html#query-ids">Query ID’s</a> for push notification responses are as follows:</p>

<table>
  <thead>
    <tr>
      <th>Query ID</th>
      <th>Response</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0x92</td>
      <td>Setting Value Push Notification</td>
    </tr>
    <tr>
      <td>0x93</td>
      <td>Status Value Push Notification</td>
    </tr>
  </tbody>
</table>

<p>Here is a generic sequence diagram of how this looks (the same is true for statuses):</p>

<svg class="plantuml" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentstyletype="text/css" height="418px" preserveaspectratio="none" style="width:622px;height:418px;background:#FFFFFF;" version="1.1" viewbox="0 0 622 418" width="622px" zoomandpan="magnify"><defs></defs><g><rect fill="#FFFFFF" height="59.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="438.5" y="131.6953"></rect><rect fill="#FFFFFF" height="59.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="438.5" y="292.3594"></rect><rect fill="none" height="88.3984" style="stroke:#000000;stroke-width:1.5;" width="561.5" x="10" y="146.6953"></rect><rect fill="none" height="59.2656" style="stroke:#000000;stroke-width:1.5;" width="211" x="405" y="307.3594"></rect><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="111" x2="111" y1="36.2969" y2="383.625"></line><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="443" x2="443" y1="36.2969" y2="383.625"></line><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="183" x="20" y="5"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="169" x="27" y="24.9951">Open GoPro user device</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="183" x="20" y="382.625"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="169" x="27" y="402.6201">Open GoPro user device</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="57" x="415" y="5"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="43" x="422" y="24.9951">GoPro</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="57" x="415" y="382.625"></rect><text fill="#000000" font-family="sans-serif" font-size="14" lengthadjust="spacing" textlength="43" x="422" y="402.6201">GoPro</text><rect fill="#FFFFFF" height="59.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="438.5" y="131.6953"></rect><rect fill="#FFFFFF" height="59.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="438.5" y="292.3594"></rect><path d="M54,51.2969 L54,76.2969 L501,76.2969 L501,61.2969 L491,51.2969 L54,51.2969 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"></path><path d="M491,51.2969 L491,61.2969 L501,61.2969 L491,51.2969 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"></path><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="256" x="145" y="68.3638">Connected (steps from connect tutorial)</text><line style="stroke:#181818;stroke-width:1.0;" x1="441.5" x2="431.5" y1="102.5625" y2="98.5625"></line><line style="stroke:#181818;stroke-width:1.0;" x1="441.5" x2="431.5" y1="102.5625" y2="106.5625"></line><line style="stroke:#181818;stroke-width:1.0;" x1="111.5" x2="442.5" y1="102.5625" y2="102.5625"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="177" x="118.5" y="97.4966">Register updates for setting</text><line style="stroke:#181818;stroke-width:1.0;" x1="112.5" x2="122.5" y1="131.6953" y2="127.6953"></line><line style="stroke:#181818;stroke-width:1.0;" x1="112.5" x2="122.5" y1="131.6953" y2="135.6953"></line><line style="stroke:#181818;stroke-width:1.0;" x1="111.5" x2="437.5" y1="131.6953" y2="131.6953"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="308" x="128.5" y="126.6294">Notification Response and Current Setting Value</text><path d="M10,146.6953 L87,146.6953 L87,153.8281 L77,163.8281 L10,163.8281 L10,146.6953 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"></path><rect fill="none" height="88.3984" style="stroke:#000000;stroke-width:1.5;" width="561.5" x="10" y="146.6953"></rect><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthadjust="spacing" textlength="32" x="25" y="159.7622">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthadjust="spacing" textlength="114" x="102" y="158.9058">[Setting changes]</text><line style="stroke:#181818;stroke-width:1.0;" x1="448.5" x2="490.5" y1="189.9609" y2="189.9609"></line><line style="stroke:#181818;stroke-width:1.0;" x1="490.5" x2="490.5" y1="189.9609" y2="202.9609"></line><line style="stroke:#181818;stroke-width:1.0;" x1="443.5" x2="490.5" y1="202.9609" y2="202.9609"></line><line style="stroke:#181818;stroke-width:1.0;" x1="443.5" x2="453.5" y1="202.9609" y2="198.9609"></line><line style="stroke:#181818;stroke-width:1.0;" x1="443.5" x2="453.5" y1="202.9609" y2="206.9609"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="104" x="455.5" y="184.895">Setting changes</text><line style="stroke:#181818;stroke-width:1.0;" x1="112.5" x2="122.5" y1="227.0938" y2="223.0938"></line><line style="stroke:#181818;stroke-width:1.0;" x1="112.5" x2="122.5" y1="227.0938" y2="231.0938"></line><line style="stroke:#181818;stroke-width:1.0;" x1="111.5" x2="442.5" y1="227.0938" y2="227.0938"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="236" x="128.5" y="222.0278">Push notification of new setting value</text><line style="stroke:#181818;stroke-width:1.0;" x1="441.5" x2="431.5" y1="263.2266" y2="259.2266"></line><line style="stroke:#181818;stroke-width:1.0;" x1="441.5" x2="431.5" y1="263.2266" y2="267.2266"></line><line style="stroke:#181818;stroke-width:1.0;" x1="111.5" x2="442.5" y1="263.2266" y2="263.2266"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="192" x="118.5" y="258.1606">Unregister updates for setting</text><line style="stroke:#181818;stroke-width:1.0;" x1="112.5" x2="122.5" y1="292.3594" y2="288.3594"></line><line style="stroke:#181818;stroke-width:1.0;" x1="112.5" x2="122.5" y1="292.3594" y2="296.3594"></line><line style="stroke:#181818;stroke-width:1.0;" x1="111.5" x2="437.5" y1="292.3594" y2="292.3594"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="138" x="128.5" y="287.2935">Notification Response</text><path d="M405,307.3594 L482,307.3594 L482,314.4922 L472,324.4922 L405,324.4922 L405,307.3594 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"></path><rect fill="none" height="59.2656" style="stroke:#000000;stroke-width:1.5;" width="211" x="405" y="307.3594"></rect><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthadjust="spacing" textlength="32" x="420" y="320.4263">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthadjust="spacing" textlength="114" x="497" y="319.5698">[Setting changes]</text><line style="stroke:#181818;stroke-width:1.0;" x1="448.5" x2="490.5" y1="350.625" y2="350.625"></line><line style="stroke:#181818;stroke-width:1.0;" x1="490.5" x2="490.5" y1="350.625" y2="363.625"></line><line style="stroke:#181818;stroke-width:1.0;" x1="443.5" x2="490.5" y1="363.625" y2="363.625"></line><line style="stroke:#181818;stroke-width:1.0;" x1="443.5" x2="453.5" y1="363.625" y2="359.625"></line><line style="stroke:#181818;stroke-width:1.0;" x1="443.5" x2="453.5" y1="363.625" y2="367.625"></line><text fill="#000000" font-family="sans-serif" font-size="13" lengthadjust="spacing" textlength="104" x="455.5" y="345.5591">Setting changes</text></g></svg>

<p>That is, after registering for push notifications for a given query, notification responses will continuously
be sent whenever the query changes until the client unregisters for push notifications for the given query.</p>

<div class="callout tip">
<i class="fa fa-tools fa-2x" style="color: #ebc21c; margin: 0.25em;"></i><span>The initial response to the Register query also contains the current setting / status value.</span>
</div>

<p>We will walk through an example of this below:</p>

<p>First, let’s register for updates when the resolution setting changes:</p>

<div>
    <ul class="tab tab-linked" data-tab="382d5739-bfa9-4b27-9191-0586e932b508">
        
            <li class="active">
                <a href="">python </a>
            </li>
        
            <li>
                <a href="">kotlin </a>
            </li>
        
        </ul>
        <ul class="tab-content" id="382d5739-bfa9-4b27-9191-0586e932b508">
        
            <li class="active tab-content-container">
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">query_request_uuid</span> <span class="o">=</span> <span class="n">GoProUuid</span><span class="p">.</span><span class="n">QUERY_REQ_UUID</span>
<span class="n">request</span> <span class="o">=</span> <span class="nf">bytes</span><span class="p">([</span><span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x52</span><span class="p">,</span> <span class="n">RESOLUTION_ID</span><span class="p">])</span>
<span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">write_gatt_char</span><span class="p">(</span><span class="n">query_request_uuid</span><span class="p">.</span><span class="n">value</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="c1"># Wait to receive the notification response
</span><span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">received_responses</span><span class="p">.</span><span class="nf">get</span><span class="p">()</span>
</code></pre></div></div>

</li>
        
            <li class="tab-content-container">
<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">val</span> <span class="py">registerResolutionUpdates</span> <span class="p">=</span> <span class="nf">ubyteArrayOf</span><span class="p">(</span><span class="mh">0x02U</span><span class="p">,</span> <span class="mh">0x52U</span><span class="p">,</span> <span class="nc">RESOLUTION_ID</span><span class="p">)</span>
<span class="n">ble</span><span class="p">.</span><span class="nf">writeCharacteristic</span><span class="p">(</span><span class="n">goproAddress</span><span class="p">,</span> <span class="nc">GoProUUID</span><span class="p">.</span><span class="nc">CQ_QUERY</span><span class="p">.</span><span class="n">uuid</span><span class="p">,</span> <span class="n">registerResolutionUpdates</span><span class="p">)</span>
</code></pre></div></div>

</li>
        
    </ul>
</div>

<p>and parse its response (which includes the current resolution value). This is very similar to the polling
example with the exception that the Query ID is now 0x52
(<a href="/OpenGoPro/ble/features/query.html#register-for-setting-value-updates">Register Updates for Settings</a>).
This can be seen in the raw byte data as well as by inspecting the response’s <code class="language-plaintext highlighter-rouge">id</code> property.</p>

<div>
    <ul class="tab tab-linked" data-tab="bf8ab916-c333-4071-999b-efb18e1f51f4">
        
            <li class="active">
                <a href="">python </a>
            </li>
        
            <li>
                <a href="">kotlin </a>
            </li>
        
        </ul>
        <ul class="tab-content" id="bf8ab916-c333-4071-999b-efb18e1f51f4">
        
            <li class="active tab-content-container">
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">response</span><span class="p">.</span><span class="nf">parse</span><span class="p">()</span>
<span class="n">resolution</span> <span class="o">=</span> <span class="nc">Resolution</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">data</span><span class="p">[</span><span class="n">RESOLUTION_ID</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="n">logger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Resolution is currently </span><span class="si">{</span><span class="n">resolution</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div>

<p>This will show in the log as such:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="go">Registering for resolution updates
Writing to GoProUuid.QUERY_REQ_UUID: 02:52:02
Received response at GoProUuid.QUERY_RSP_UUID: 05:52:00:02:01:09
Received the Resolution Query response
Successfully registered for resolution value updates
Resolution is currently Resolution.RES_1080
</span></code></pre></div></div>

</li>
        
            <li class="tab-content-container">
<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">val</span> <span class="py">queryResponse</span> <span class="p">=</span> <span class="p">(</span><span class="n">receivedResponses</span><span class="p">.</span><span class="nf">receive</span><span class="p">()</span> <span class="k">as</span> <span class="nc">Response</span><span class="p">.</span><span class="nc">Query</span><span class="p">).</span><span class="nf">apply</span> <span class="p">{</span> <span class="nf">parse</span><span class="p">()</span> <span class="p">}</span>
<span class="n">resolution</span> <span class="p">=</span> <span class="nc">Resolution</span><span class="p">.</span><span class="nf">fromValue</span><span class="p">(</span><span class="n">queryResponse</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="nf">getValue</span><span class="p">(</span><span class="nc">RESOLUTION_ID</span><span class="p">).</span><span class="nf">first</span><span class="p">())</span>
</code></pre></div></div>

<p>This will show in the log as such:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="go">Registering for resolution value updates
</span><span class="gp">Writing characteristic b5f90076-aa8d-11e3-9046-0002a5d5c51b ==&gt;</span><span class="w"> </span>02:52:02
<span class="go">Wrote characteristic b5f90076-aa8d-11e3-9046-0002a5d5c51b
Characteristic b5f90077-aa8d-11e3-9046-0002a5d5c51b changed | value: 05:52:00:02:01:04
Received response on CQ_QUERY_RSP
Received packet of length 5. 0 bytes remaining
Received Query Response
Camera resolution is RES_2_7K
</span></code></pre></div></div>

</li>
        
    </ul>
</div>

<p>We are now successfully registered for resolution value updates and will receive push notifications whenever
the resolution changes. We verify this in the demo by then changing the resolution and waiting to receive the update.
notification..</p>

<div>
    <ul class="tab tab-linked" data-tab="8714dab8-7659-48e9-9c56-1935523012b3">
        
            <li class="active">
                <a href="">python </a>
            </li>
        
            <li>
                <a href="">kotlin </a>
            </li>
        
        </ul>
        <ul class="tab-content" id="8714dab8-7659-48e9-9c56-1935523012b3">
        
            <li class="active tab-content-container">
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">target_resolution</span> <span class="o">=</span> <span class="n">Resolution</span><span class="p">.</span><span class="n">RES_2_7K</span> <span class="k">if</span> <span class="n">resolution</span> <span class="ow">is</span> <span class="n">Resolution</span><span class="p">.</span><span class="n">RES_1080</span> <span class="k">else</span> <span class="n">Resolution</span><span class="p">.</span><span class="n">RES_1080</span>
<span class="n">request</span> <span class="o">=</span> <span class="nf">bytes</span><span class="p">([</span><span class="mh">0x03</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="n">target_resolution</span><span class="p">.</span><span class="n">value</span><span class="p">])</span>
<span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">write_gatt_char</span><span class="p">(</span><span class="n">setting_request_uuid</span><span class="p">.</span><span class="n">value</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">received_responses</span><span class="p">.</span><span class="nf">get</span><span class="p">()</span>
<span class="n">response</span><span class="p">.</span><span class="nf">parse</span><span class="p">()</span>

<span class="k">while</span> <span class="n">resolution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">target_resolution</span><span class="p">:</span>
    <span class="n">request</span> <span class="o">=</span> <span class="nf">bytes</span><span class="p">([</span><span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x12</span><span class="p">,</span> <span class="n">RESOLUTION_ID</span><span class="p">])</span>
    <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">write_gatt_char</span><span class="p">(</span><span class="n">query_request_uuid</span><span class="p">.</span><span class="n">value</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">response</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">received_responses</span><span class="p">.</span><span class="nf">get</span><span class="p">()</span>  <span class="c1"># Wait to receive the notification response
</span>    <span class="n">response</span><span class="p">.</span><span class="nf">parse</span><span class="p">()</span>
    <span class="n">resolution</span> <span class="o">=</span> <span class="nc">Resolution</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">data</span><span class="p">[</span><span class="n">RESOLUTION_ID</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</code></pre></div></div>

<p>This will show in the log as such:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="go">Changing the resolution to Resolution.RES_2_7K...
Writing to GoProUuid.SETTINGS_REQ_UUID: 03:02:01:04
Received response at GoProUuid.SETTINGS_RSP_UUID: 02:02:00
Received Set Setting command response.
Waiting to receive new resolution
Received response at GoProUuid.QUERY_RSP_UUID: 05:92:00:02:01:04
Received the Resolution Query response
Resolution is currently Resolution.RES_2_7K
Resolution has changed as expected. Exiting...
</span></code></pre></div></div>

</li>
        
            <li class="tab-content-container">
<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">val</span> <span class="py">targetResolution</span> <span class="p">=</span> <span class="k">if</span> <span class="p">(</span><span class="n">resolution</span> <span class="p">==</span> <span class="nc">Resolution</span><span class="p">.</span><span class="nc">RES_2_7K</span><span class="p">)</span> <span class="nc">Resolution</span><span class="p">.</span><span class="nc">RES_1080</span> <span class="k">else</span> <span class="nc">Resolution</span><span class="p">.</span><span class="nc">RES_2_7K</span>
<span class="kd">val</span> <span class="py">setResolution</span> <span class="p">=</span> <span class="nf">ubyteArrayOf</span><span class="p">(</span><span class="mh">0x03U</span><span class="p">,</span> <span class="nc">RESOLUTION_ID</span><span class="p">,</span> <span class="mh">0x01U</span><span class="p">,</span> <span class="n">targetResolution</span><span class="p">.</span><span class="n">value</span><span class="p">)</span>
<span class="n">ble</span><span class="p">.</span><span class="nf">writeCharacteristic</span><span class="p">(</span><span class="n">goproAddress</span><span class="p">,</span> <span class="nc">GoProUUID</span><span class="p">.</span><span class="nc">CQ_SETTING</span><span class="p">.</span><span class="n">uuid</span><span class="p">,</span> <span class="n">setResolution</span><span class="p">)</span>
<span class="kd">val</span> <span class="py">setResolutionResponse</span> <span class="p">=</span> <span class="p">(</span><span class="n">receivedResponses</span><span class="p">.</span><span class="nf">receive</span><span class="p">()</span> <span class="k">as</span> <span class="nc">Response</span><span class="p">.</span><span class="nc">Tlv</span><span class="p">).</span><span class="nf">apply</span> <span class="p">{</span> <span class="nf">parse</span><span class="p">()</span> <span class="p">}</span>

<span class="c1">// Verify we receive the update from the camera when the resolution changes</span>
<span class="k">while</span> <span class="p">(</span><span class="n">resolution</span> <span class="p">!=</span> <span class="n">targetResolution</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">val</span> <span class="py">queryNotification</span> <span class="p">=</span> <span class="p">(</span><span class="n">receivedResponses</span><span class="p">.</span><span class="nf">receive</span><span class="p">()</span> <span class="k">as</span> <span class="nc">Response</span><span class="p">.</span><span class="nc">Query</span><span class="p">).</span><span class="nf">apply</span> <span class="p">{</span> <span class="nf">parse</span><span class="p">()</span> <span class="p">}</span>
    <span class="n">resolution</span> <span class="p">=</span> <span class="nc">Resolution</span><span class="p">.</span><span class="nf">fromValue</span><span class="p">(</span><span class="n">queryNotification</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="nf">getValue</span><span class="p">(</span><span class="nc">RESOLUTION_ID</span><span class="p">).</span><span class="nf">first</span><span class="p">())</span>
<span class="p">}</span>
</code></pre></div></div>

<p>We can see change happen in the log:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="go">Changing the resolution to RES_2_7K
</span><span class="gp">Writing characteristic b5f90074-aa8d-11e3-9046-0002a5d5c51b ==&gt;</span><span class="w"> </span>03:02:01:04
<span class="go">Wrote characteristic b5f90074-aa8d-11e3-9046-0002a5d5c51b
Resolution successfully changed
Waiting for camera to inform us about the resolution change
Characteristic b5f90077-aa8d-11e3-9046-0002a5d5c51b changed | value: 05:92:00:02:01:04
Received response on b5f90077-aa8d-11e3-9046-0002a5d5c51b: 05:92:00:02:01:04
Received resolution query response
Resolution is now RES_2_7K
</span></code></pre></div></div>

</li>
        
    </ul>
</div>

<p>In this case, the Query ID is 0x92 (Setting Value Push Notification) as expected.</p>

<hr>

<div class="callout tip">
<i class="fa fa-tools fa-2x" style="color: #ebc21c; margin: 0.25em;"></i><span>Multiple push notifications can be registered / received in a similar manner that multiple queries were
polled above</span>
</div>

<p><strong>Quiz time! 📚 ✏️</strong></p>

<div id="quiz_1753bd21-2d36-4c71-b678-fe2c7cdef198" class="quiz">
    <div>
        <div id="question_1753bd21-2d36-4c71-b678-fe2c7cdef198" class="quiz__question">True or False: We can still poll a given query value while we are currently registered to
    receive push notifications for it.</div>
        <div id="answers_1753bd21-2d36-4c71-b678-fe2c7cdef198">
        
            <input type="radio" name="question" value="A"><label>A: True</label>
            <br>
        
            <input type="radio" name="question" value="B"><label>B: False</label>
            <br>
        
        </div>
    </div>
    <button onclick="showResults('1753bd21-2d36-4c71-b678-fe2c7cdef198', 'A')">Submit Answer</button>
    <div id="results_1753bd21-2d36-4c71-b678-fe2c7cdef198" style="display: none">
        <span id="correct_1753bd21-2d36-4c71-b678-fe2c7cdef198" style="display: none">  Correct!! 😃</span>
        <span id="incorrect_1753bd21-2d36-4c71-b678-fe2c7cdef198" style="display: none"> Incorrect!! 😭 The correct answer is A.</span>
        While there is probably not a good reason to do so, there is nothing preventing polling
        in this manner.
    </div>
</div>

<div id="quiz_113c3669-3e17-4493-8e27-928fada4f721" class="quiz">
    <div>
        <div id="question_113c3669-3e17-4493-8e27-928fada4f721" class="quiz__question">True or False: A push notification for a registered setting will only ever contain query information
    about one setting ID.</div>
        <div id="answers_113c3669-3e17-4493-8e27-928fada4f721">
        
            <input type="radio" name="question" value="A"><label>A: True</label>
            <br>
        
            <input type="radio" name="question" value="B"><label>B: False</label>
            <br>
        
        </div>
    </div>
    <button onclick="showResults('113c3669-3e17-4493-8e27-928fada4f721', 'B')">Submit Answer</button>
    <div id="results_113c3669-3e17-4493-8e27-928fada4f721" style="display: none">
        <span id="correct_113c3669-3e17-4493-8e27-928fada4f721" style="display: none">  Correct!! 😃</span>
        <span id="incorrect_113c3669-3e17-4493-8e27-928fada4f721" style="display: none"> Incorrect!! 😭 The correct answer is B.</span>
        It is possible for push notifications to contain multiple setting ID’s if both setting ID’s have
    push notifications registered and both settings change at the same time.
    </div>
</div>

<h1 id="troubleshooting">Troubleshooting</h1>

<p>See the first tutorial’s
<a href="/OpenGoPro/tutorials/connect-ble#troubleshooting">troubleshooting section</a>.</p>

<h1 id="good-job">Good Job!</h1>

<div class="callout success">
<i class="fa fa-check-circle fa-2x" style="color: #2dcb71; margin: 0.25em;"></i><span>Congratulations 🤙</span>
</div>

<p>You can now query any of the settings / statuses from the camera using one of the above patterns.</p>

        
      </section>

      <footer class="page__meta">
        
        


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time class="dt-published" datetime="2025-06-20T14:55:48-07:00">June 20, 2025</time></p>

      </footer>

      

      
  <nav class="pagination">
    
      <a href="/OpenGoPro/tutorials/parse-ble-responses" class="pagination--pager" title="Tutorial 3: Parse BLE TLV Responses
">Previous</a>
    
    
      <a href="/OpenGoPro/tutorials/ble-protobuf" class="pagination--pager" title="Tutorial 5: BLE Protobuf Operations
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
</div>

      
    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap">
<form class="search-content__form" onkeydown="return event.key != 'Enter';" role="search">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term...">
  </form>
  <div id="results" class="results"></div>
</div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
    <ul class="social-icons">
        
        <li><strong>Follow:</strong></li>
           
        <li>
            <a href="https://www.gopro.com" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-link" aria-hidden="true"></i>
                Website</a>
        </li>
          
        <li>
            <a href="https://twitter.com/GoPro" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i>
                Twitter</a>
        </li>
          
        <li>
            <a href="https://www.facebook.com/gopro/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-facebook-square" aria-hidden="true"></i>
                Facebook</a>
        </li>
          
        <li>
            <a href="https://github.com/gopro" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i>
                GitHub</a>
        </li>
          
        <li>
            <a href="https://www.instagram.com/gopro/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i>
                Instagram</a>
        </li>
           
    </ul>
</div>

<div class="page__footer-copyright">
    © 2025 . Powered by
    <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp;
    <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.
    <p>
        Can be used with GoPro® HERO9 and HERO10 cameras. You must include the following text on
        every page where it can be seen by someone purchasing such an item: <em>"This product
        and/or service is not affiliated with, endorsed by or in any way associated with
        GoPro Inc. or its products and services. GoPro, HERO, and their respective logos
        are trademarks or registered trademarks of GoPro, Inc."</em>
    </p>
</div>

      </footer>
    </div>

    
  <script src="/OpenGoPro/assets/js/main.min.js"></script>




<script src="/OpenGoPro/assets/js/lunr/lunr.min.js"></script>
<script src="/OpenGoPro/assets/js/lunr/lunr-store.js"></script>
<script src="/OpenGoPro/assets/js/lunr/lunr-en.js"></script>






  </body>
</html>
